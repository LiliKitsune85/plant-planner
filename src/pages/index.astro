---
export const prerender = false;

const defaultDestination = "/calendar";

const {
  data: { user },
} = await Astro.locals.supabase.auth.getUser();

if (user) {
  return Astro.redirect(defaultDestination);
}

const loginUrl = new URL("/auth/login", Astro.url);
loginUrl.searchParams.set("returnTo", defaultDestination);

return Astro.redirect(loginUrl);
---
